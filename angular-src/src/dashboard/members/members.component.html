<div class="container">
    <div class="row">
        <div class="col-2">
            <mat-form-field appearance="fill" class="selector">
                <mat-label>Wybierz członka</mat-label>
                <mat-select [(value)]="selectedMember" (selectionChange)="onMemberChange($event)">
                    <mat-option *ngFor="let member of members" [value]="member.id">
                        {{ member.display_name }}
                    </mat-option>
                </mat-select>
            </mat-form-field>
        </div>
        <div class="col-2 offset-8">
            <button mat-raised-button color="accent" (click)="createNewMember()">Nowy członek</button>
        </div>
    </div>
    <mat-card>
        <mat-card-header>
            <mat-card-title>Dane osobowe</mat-card-title>
        </mat-card-header>
        <mat-card-content>
            <form [formGroup]="memberForm">
                <div class="row">
                    <div class="col-6 ">
                        <mat-form-field>
                            <mat-label>Imię</mat-label>
                            <input matInput formControlName="first_name" />
                        </mat-form-field>
                    </div>
                    <div class="col-6">
                        <mat-form-field>
                            <mat-label>Nazwisko</mat-label>
                            <input matInput formControlName="last_name" />
                        </mat-form-field>
                    </div>
                </div>
                <div class="row">
                    <div class="col-9">
                        <mat-form-field>
                            <mat-label>Ulica</mat-label>
                            <input matInput formControlName="street" />
                        </mat-form-field>
                    </div>
                    <div class="col-3">
                        <mat-form-field>
                            <mat-label>Nr domu</mat-label>
                            <input matInput formControlName="house_no" />
                        </mat-form-field>
                    </div>
                </div>
                <div class="row">
                    <div class="col-3">
                        <mat-form-field>
                            <mat-label>Kod pocztowy</mat-label>
                            <input matInput formControlName="postal_code" maxlength="6" pattern="[0-9]{2}-[0-9]{3}"
                                (input)="onPostalCodeInput($event)" />
                            <mat-error
                                *ngIf="memberForm.get('postal_code')?.invalid && memberForm.get('postal_code')?.touched">
                                Kod pocztowy musi mieć format XX-XXX
                            </mat-error>
                        </mat-form-field>
                    </div>
                    <div class="col-9">
                        <mat-form-field>
                            <mat-label>Miasto</mat-label>
                            <input matInput formControlName="town" />
                        </mat-form-field>
                    </div>
                </div>
                <div class="row">
                    <div class="col-4">
                        <mat-form-field>
                            <mat-label>PESEL</mat-label>
                            <input matInput formControlName="pesel" maxlength="11" pattern="[0-9]*"
                                (input)="onPeselInput($event)" />
                            <mat-error *ngIf="memberForm.get('pesel')?.invalid && memberForm.get('pesel')?.touched">
                                PESEL musi mieć 11 cyfr
                            </mat-error>
                        </mat-form-field>
                    </div>
                    <div class="col-8">
                        <mat-form-field>
                            <mat-label>Miejsce urodzenia</mat-label>
                            <input matInput formControlName="birth_place" />
                        </mat-form-field>
                    </div>
                </div>
                <div class="row">
                    <div class="col-6">
                        <mat-form-field>
                            <mat-label>Numer konta</mat-label>
                            <input matInput placeholder="00 0000 0000 0000 0000 0000 0000" formControlName="account_no"
                                appBankAccountInput />
                            <mat-error
                                *ngIf="memberForm.get('account_no')?.invalid && memberForm.get('account_no')?.touched">
                                Nieprawidłowy numer konta (powinien składać się z 26 cyfr)
                            </mat-error>
                        </mat-form-field>
                    </div>
                    <div class="col-6">
                        <mat-form-field>
                            <mat-label>Urząd skarbowy</mat-label>
                            <input matInput formControlName="tax_office" />
                        </mat-form-field>
                    </div>
                </div>
            </form>
        </mat-card-content>
        <mat-card-actions>
            <button mat-raised-button color="primary" (click)="toggleEditMode()">
                {{ isEditing ? 'Zapisz' : 'Edytuj' }}
            </button>
            <button mat-raised-button color="primary" (click)="copyToClipboard()">
                Kopiuj do schowka
            </button>
        </mat-card-actions>
    </mat-card>
    <mat-card>
        <mat-card-header>
            <mat-card-title>Generator umów</mat-card-title>
        </mat-card-header>
        <mat-card-content>
            <form [formGroup]="contractForm">
                <div class="row">
                    <div class="col-6">
                        <mat-form-field>
                            <mat-label>Tytuł umowy</mat-label>
                            <input matInput formControlName="contract_title" />
                        </mat-form-field>
                    </div>
                    <div class="col-6">
                        <fieldset>
                            <legend class="col-form-label pt-0">Typ umowy</legend>
                            <mat-radio-group formControlName="contract_type">
                                <mat-radio-button value="zlecenie">Zlecenie</mat-radio-button>
                                <mat-radio-button value="dzielo">O dzieło</mat-radio-button>
                            </mat-radio-group>
                        </fieldset>
                    </div>
                </div>
            </form>
        </mat-card-content>
        <mat-card-actions>
            <button mat-raised-button color="primary" (click)="generateContract()">Generuj umowę</button>
        </mat-card-actions>
    </mat-card>
</div>

<mat-spinner *ngIf="isLoading" class="spinner"></mat-spinner>